{
  "version": 3,
  "sources": [
    "../../../../src/service/evidence-center.js"
  ],
  "names": [
    "path",
    "require",
    "fs",
    "server",
    "sword",
    "config",
    "serverWeb",
    "ROOT_PATH",
    "getDistributedConfigPath",
    "dirArr",
    "split",
    "sep",
    "splice",
    "length",
    "projectPath",
    "join",
    "distributedConfigPath",
    "serverConfig",
    "existsSync",
    "readFileSync",
    "configServer",
    "flag",
    "JSON",
    "parse",
    "subserver",
    "forEach",
    "item",
    "enable",
    "mainserver",
    "host",
    "ip",
    "port",
    "serverwebport",
    "name",
    "method",
    "pack"
  ],
  "mappings": "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",
  "sourcesContent": [
    "const path = require('path');\r\nconst fs = require('fs');\r\n\r\nconst server = sword.config('server');\r\nconst serverWeb = sword.config('serverWeb');\r\nconst ROOT_PATH = sword.ROOT_PATH;\r\n/**\r\n * 启动时配置http服务器信息\r\n */\r\nfunction getDistributedConfigPath() {\r\n    const dirArr = ROOT_PATH.split(path.sep);\r\n    dirArr.splice(dirArr.length - 2, dirArr.length - 1);\r\n    const projectPath = dirArr.join(path.sep);\r\n    const distributedConfigPath = path.join(projectPath, 'TransmitServer', 'config', 'evidencedistributedconfig.json');\r\n    let serverConfig = null;\r\n    if (fs.existsSync(distributedConfigPath)) {\r\n        serverConfig = fs.readFileSync(distributedConfigPath);\r\n    }\r\n    return serverConfig;\r\n}\r\nfunction configServer() {\r\n    let flag = 0;\r\n    let serverConfig = getDistributedConfigPath();\r\n    if (serverConfig) {\r\n        // eslint-disable-next-line no-const-assign\r\n        serverConfig = JSON.parse(serverConfig);\r\n        serverConfig.subserver.forEach(item => {\r\n            // eslint-disable-next-line eqeqeq\r\n            if (item.enable != 0) {\r\n                flag = 1;\r\n            }\r\n        });\r\n        // eslint-disable-next-line eqeqeq\r\n        if (serverConfig.mainserver.enable != 0 || flag === 1) {\r\n            // 分布式部署,写日志往主服务器写\r\n            serverWeb[0].host = serverConfig.mainserver.ip;\r\n            serverWeb[0].port = serverConfig.mainserver.serverwebport;\r\n        }\r\n    }\r\n}\r\nconfigServer();\r\n\r\nexport default [\r\n    {\r\n        name: 'evidenceCenterDetail',\r\n        server,\r\n        path: '/alarm/detailandhandle',\r\n        method: 'post',\r\n        pack: 'json'\r\n    },\r\n    {\r\n        name: 'evidenceCenterSendEmail',\r\n        server,\r\n        path: '/api/v1/evidence/sendmail',\r\n        method: 'post',\r\n        pack: 'json'\r\n    },\r\n    {\r\n        name: 'evidenceCenterRelatedgpsalarm',\r\n        server,\r\n        path: '/alarm/relatedgpsalarm',\r\n        method: 'post',\r\n        pack: 'json'\r\n    },\r\n    {\r\n        name: 'evidenceCenterAlarmStatus',\r\n        server,\r\n        path: '/alarm/status',\r\n        method: 'post',\r\n        pack: 'json'\r\n    },\r\n    {\r\n        name: 'evidenceCenterGetDownloadUrl',\r\n        server,\r\n        path: '/api/v1/evidence/download/pack?key=123',\r\n        method: 'post',\r\n        pack: 'json'\r\n    },\r\n    {\r\n        name: 'evidenceCenterLogDownload',\r\n        server: serverWeb,\r\n        path: '/opt/add',\r\n        method: 'post',\r\n        pack: 'json'\r\n    },\r\n    {\r\n        name: 'getDriverNameList',\r\n        server,\r\n        path: '/api/v1/base/drivers',\r\n        method: 'post',\r\n        pack: 'json'\r\n    },\r\n    {\r\n        name: 'saveEvidence',\r\n        server,\r\n        path: '/api/v1/evidence/save',\r\n        method: 'post',\r\n        pack: 'json'\r\n    },\r\n    {\r\n        name: 'evidenceSubServerInfo',\r\n        server,\r\n        path: '/api/v1/evidence/evidenceserverinfo',\r\n        method: 'post',\r\n        pack: 'json'\r\n    },\r\n    {\r\n        name: 'deletePack',\r\n        server,\r\n        path: '/api/v1/evidence/download/delpack',\r\n        method: 'post',\r\n        pack: 'json'\r\n    }\r\n];\r\n"
  ],
  "file": "evidence-center.js"
}